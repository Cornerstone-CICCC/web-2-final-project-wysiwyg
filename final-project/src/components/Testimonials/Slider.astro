---
import Testimonial, { type TestimonialProps } from "./Testimonial.astro";
import ArrowLeft from "../../assets/icons/arrow-left.svg";
import ArrowRight from "../../assets/icons/arrow-right.svg";
// import Swiper styles
import "swiper/swiper-bundle.css";

const slides: TestimonialProps[] = [
  {
    content:
      "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse varius enim in eros elementum tristique. Duis cursus, mi quis viverra ornare.",
    user: {
      name: "Brendan Atkinson",
      position: "SE, Silver Automations Ltd",
      avatar: "https://pics.craiyon.com/2023-11-26/oMNPpACzTtO5OVERUZwh3Q.webp",
    },
    link: "#",
    mainLogo: "",
  },
  {
    content:
      "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse varius enim in eros elementum tristique. Duis cursus, mi quis viverra ornare.",
    user: {
      name: "Tia Ackroyd",
      position: "Sales Manager, Ackroyd Cars Ltd",
      avatar: "https://pics.craiyon.com/2023-11-26/oMNPpACzTtO5OVERUZwh3Q.webp",
    },
    link: "#",
    mainLogo: "",
  },
  {
    content:
      "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse varius enim in eros elementum tristique. Duis cursus, mi quis viverra ornare.",
    user: {
      name: "David Oswald",
      position: "Oswald, Oswald Cabs",
      avatar: "https://pics.craiyon.com/2023-11-26/oMNPpACzTtO5OVERUZwh3Q.webp",
    },
    link: "#",
    mainLogo: "",
  },
  {
    content:
      "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse varius enim in eros elementum tristique. Duis cursus, mi quis viverra ornare.",
    user: {
      name: "Name Surname",
      position: "Position, Company name",
      avatar: "https://pics.craiyon.com/2023-11-26/oMNPpACzTtO5OVERUZwh3Q.webp",
    },
    link: "#",
    mainLogo: "",
  },
  {
    content:
      "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse varius enim in eros elementum tristique. Duis cursus, mi quis viverra ornare.",
    user: {
      name: "Name Surname",
      position: "Position, Company name",
      avatar: "https://pics.craiyon.com/2023-11-26/oMNPpACzTtO5OVERUZwh3Q.webp",
    },
    link: "#",
    mainLogo: "",
  },
  {
    content:
      "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse varius enim in eros elementum tristique. Duis cursus, mi quis viverra ornare.",
    user: {
      name: "Name Surname",
      position: "Position, Company name",
      avatar: "https://pics.craiyon.com/2023-11-26/oMNPpACzTtO5OVERUZwh3Q.webp",
    },
    link: "#",
    mainLogo: "",
  },
  {
    content:
      "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse varius enim in eros elementum tristique. Duis cursus, mi quis viverra ornare.",
    user: {
      name: "Name Surname",
      position: "Position, Company name",
      avatar: "https://pics.craiyon.com/2023-11-26/oMNPpACzTtO5OVERUZwh3Q.webp",
    },
    link: "#",
    mainLogo: "",
  },
  {
    content:
      "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse varius enim in eros elementum tristique. Duis cursus, mi quis viverra ornare.",
    user: {
      name: "Name Surname",
      position: "Position, Company name",
      avatar: "https://pics.craiyon.com/2023-11-26/oMNPpACzTtO5OVERUZwh3Q.webp",
    },
    link: "#",
    mainLogo: "",
  },
];
---

<div class="mySwiper">
  <div class="swiper">
    <div class="swiper-wrapper">
      <!-- Slides -->
      {
        slides.map((sliderItem) => (
          <div class="swiper-slide">
            <Testimonial {...sliderItem} />
          </div>
        ))
      }
    </div>
  </div>
  <!-- If we need navigation buttons -->
  <div class="swiper-controls">
    <div class="swiper-navigation">
      <button
        class="swiper-button-prev"
        style={{ backgroundImage: `url(${ArrowLeft.src})` }}></button>
      <button
        class="swiper-button-next"
        style={{ backgroundImage: `url(${ArrowRight.src})` }}></button>
    </div>
    <div class="swiper-pagination"></div>
  </div>
</div>

<script>
  import Swiper from "swiper";
  import { Navigation, Pagination } from "swiper/modules";
  Swiper.use([Navigation, Pagination]);
  const swiper = new Swiper(".swiper", {
    direction: "horizontal",
    slidesPerView: 1,
    spaceBetween: 30,
    breakpoints: {
      768: {
        slidesPerView: 2,
        spaceBetween: 30,
      },
      992: {
        slidesPerView: 3,
        spaceBetween: 30,
      },
    },
    pagination: {
      enabled: true,
      el: ".swiper-pagination",
      clickable: true,
    },
  });

  swiper.on("resize", function () {
    console.log({ swiper });
  });

  // register navigation buttons
  document
    .querySelector(".swiper-button-next")
    ?.addEventListener("click", function () {
      swiper.slideNext();
    });
  document
    .querySelector(".swiper-button-prev")
    ?.addEventListener("click", function () {
      swiper.slidePrev();
    });
</script>

<style>
  :root {
    --swiper-theme-color: #000;
    --swiper-navigation-size: 48px;
  }
  .mySwiper {
    position: relative;
    height: 400px;
    padding: 0.5rem;
    margin-bottom: 4rem;
  }
  .swiper {
    width: 100%;
    height: 100%;
  }

  .swiper-slide {
    text-align: center;
    background: #fff;
  }

  .swiper-slide img {
    display: block;
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .swiper-controls {
    display: flex;
    flex-direction: row-reverse;
    justify-content: space-between;
    height: 56px;
    align-items: center;
  }

  .swiper-controls > * {
    position: relative;
    margin-top: 2rem;
  }

  .swiper-navigation {
    display: flex;
    justify-content: flex-end;
    width: 40%;
    height: 100%;
  }

  .swiper-pagination {
    display: flex;
    justify-content: flex-start;
    align-items: center;
    height: 100%;
    max-width: 60%;
    bottom: 0;
  }

  .swiper-controls .swiper-button-next,
  .swiper-controls .swiper-button-prev {
    position: relative;
    border: 1px solid #000;
    border-radius: 50%;
    width: 48px;
    height: 48px;
    color: black;
    padding: 1.3rem;
    background-color: #fff;
    background-repeat: no-repeat;
    background-size: 16px auto;
    background-position: center;
  }

  .swiper-controls .swiper-button-prev {
    margin-right: 2.5rem;
  }

  .swiper-controls .swiper-button-next::after,
  .swiper-controls .swiper-button-prev::after {
    display: none;
  }

  @media screen and (min-width: 768px) {
    .mySwiper {
      height: 420px;
    }
    .swiper-controls > * {
      position: absolute;
      width: 100%;
    }
    .swiper-controls .swiper-navigation {
      top: 0;
      height: 100%;
      width: 100%;
      margin-top: 0;
    }
    .swiper-controls .swiper-button-next,
    .swiper-controls .swiper-button-prev {
      width: 48px;
      height: 48px;
      position: absolute;
    }
    .swiper-controls .swiper-pagination {
      margin-bottom: -3rem;
    }
    .swiper-controls .swiper-button-next {
      margin-right: -1.9rem;
    }
    .swiper-controls .swiper-button-prev {
      margin-left: -0.9rem;
    }

    .swiper-pagination {
      height: 56px;
      min-width: 100%;
      justify-content: center;
      bottom: -2rem;
    }
  }
</style>
